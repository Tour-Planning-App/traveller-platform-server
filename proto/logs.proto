syntax = "proto3";
package logs;

import "google/protobuf/timestamp.proto";

service LogsService {
  rpc CreateLog(CreateLogRequest) returns (CreateLogResponse);
  rpc GetLogById(GetLogByIdRequest) returns (GetLogResponse);
  rpc GetLogs(GetLogsRequest) returns (GetLogsResponse);
  rpc GetLogsByUser(GetLogsByUserRequest) returns (GetLogsResponse);
  rpc GetLogsByService(GetLogsByServiceRequest) returns (GetLogsResponse);
}

message CreateLogRequest {
  string service_name = 1;      // e.g., "community-service"
  string action = 2;             // e.g., "POST_CREATED", "POST_UPDATED"
  string user_id = 3;            // User who performed the action
  string resource_id = 4;        // ID of the resource (e.g., postId)
  string resource_type = 5;      // Type of resource (e.g., "post", "comment")
  string details = 6;            // Additional details in JSON format
  string status = 7;             // "success", "error", "warning"
  string ip_address = 8;         // Optional: IP address of request
}

message CreateLogResponse {
  bool success = 1;
  string message = 2;
  string log_id = 3;
}

message GetLogByIdRequest {
  string log_id = 1;
}

message GetLogResponse {
  bool success = 1;
  string message = 2;
  Log log = 3;
}

message GetLogsRequest {
  int32 limit = 1;
  int32 offset = 2;
  string status = 3;           // Filter by status
  string service_name = 4;     // Filter by service
}

message GetLogsByUserRequest {
  string user_id = 1;
  int32 limit = 2;
  int32 offset = 3;
}

message GetLogsByServiceRequest {
  string service_name = 1;
  int32 limit = 2;
  int32 offset = 3;
}

message GetLogsResponse {
  bool success = 1;
  string message = 2;
  repeated Log logs = 3;
  int32 total = 4;
}

message Log {
  string id = 1;
  string service_name = 2;
  string action = 3;
  string user_id = 4;
  string resource_id = 5;
  string resource_type = 6;
  string details = 7;
  string status = 8;
  string ip_address = 9;
  google.protobuf.Timestamp created_at = 10;
}
